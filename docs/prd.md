# PRD: AI 사주 분석 구독 서비스

## 1. 제품 개요

### 1.1 프로젝트 배경

현대인들의 사주 분석에 대한 관심은 높지만, 전문가 상담은 비용이 높고 접근성이 낮습니다. 본 서비스는 Google Gemini AI를 활용하여 합리적인 가격으로 정확한 사주 분석을 제공하고, 사용자가 언제든 분석 결과를 열람할 수 있도록 지원합니다.

### 1.2 제품 비전

"AI 기술로 모든 사람이 쉽게 접근할 수 있는 정확한 사주 분석 서비스"

### 1.3 핵심 가치 제안

- **AI 기반 정확한 분석**: Google Gemini 2.5 Pro 모델을 활용한 체계적인 사주 해석
- **합리적인 가격**: 월 3,900원으로 월 10회 고품질 분석 제공
- **영구 보관**: 모든 분석 결과를 대시보드에서 언제든 다시 확인 가능
- **무료 체험**: 신규 가입자에게 1회 무료 분석 기회 제공

---

## 2. Stakeholders

### 2.1 내부 이해관계자

- **제품 관리자**: 서비스 기획, 로드맵 관리, KPI 모니터링
- **개발팀**: 프론트엔드, 백엔드, 인프라 개발 및 유지보수
- **디자이너**: UI/UX 디자인, 사용자 경험 최적화
- **운영팀**: 고객 지원, 결제 이슈 대응, 데이터 관리

### 2.2 외부 이해관계자

- **최종 사용자**: 사주 분석을 원하는 일반 사용자
- **Google (Gemini API)**: AI 모델 제공 및 API 관리
- **Clerk**: 사용자 인증 및 세션 관리 서비스
- **토스페이먼츠**: 구독 결제 및 빌링 처리
- **Supabase**: 데이터베이스 및 백엔드 인프라 제공

---

## 3. 포함 페이지

### 3.1 페이지 구조 개요

```
/ (홈/랜딩)
├── /sign-in (로그인)
├── /sign-up (회원가입)
├── /dashboard (대시보드)
│   ├── /analysis/new (새 분석하기)
│   └── /analysis/[id] (분석 상세보기)
├── /subscription (구독 관리)
└── /api
    ├── /api/webhooks/clerk (Clerk 웹훅)
    ├── /api/webhooks/tosspayments (토스페이먼츠 웹훅)
    ├── /api/billing/success (결제 성공 콜백)
    └── /api/billing/fail (결제 실패 콜백)
```

### 3.2 페이지별 상세 정보

#### 3.2.1 홈 (랜딩페이지) `/`

- **접근 권한**: 인증 불필요 (공개)
- **목적**: 서비스 소개 및 신규 가입 유도
- **주요 구성 요소**:
  - 히어로 섹션: "AI가 풀어주는 당신의 사주팔자"
  - 주요 특징 3개 카드 (AI 기반 분석, 합리적 가격, 영구 보관)
  - 가격 안내 (무료 1회, Pro 월 3,900원/10회)
  - CTA 버튼: "무료로 시작하기"

#### 3.2.2 로그인/회원가입 `/sign-in`, `/sign-up`

- **접근 권한**: 인증 불필요 (공개)
- **목적**: Clerk를 통한 사용자 인증
- **주요 구성 요소**:
  - Clerk 기본 제공 컴포넌트 (SignIn, SignUp)
  - Google 소셜 로그인 지원

#### 3.2.3 대시보드 `/dashboard`

- **접근 권한**: 인증 필요
- **목적**: 사용자 현황 및 분석 이력 조회
- **주요 구성 요소**:
  - 사용자 환영 메시지
  - 현재 구독 상태 배지 (무료/Pro)
  - 남은 분석 횟수 표시
  - Pro 업그레이드 버튼 (무료 유저만)
  - 새 분석하기 버튼 (주요 CTA)
  - 분석 이력 목록 (최신순, 페이지네이션)
  - 구독 관리 페이지 링크

#### 3.2.4 새 분석하기 `/analysis/new`

- **접근 권한**: 인증 필요
- **목적**: 사주 분석 요청 및 생성
- **주요 구성 요소**:
  - 남은 분석 횟수 상태 표시
  - 입력 폼:
    - 생년월일 (DatePicker)
    - 출생 시간 (TimePicker, "모름" 옵션)
    - 양력/음력 선택 (라디오 버튼)
    - 성별 선택 (라디오 버튼)
  - 분석하기 버튼 (로딩 상태 표시)
  - 제한 초과 시 안내 메시지

#### 3.2.5 분석 상세보기 `/analysis/[id]`

- **접근 권한**: 인증 필요 (본인 분석만 조회 가능)
- **목적**: 생성된 사주 분석 결과 확인
- **주요 구성 요소**:
  - 분석 정보 헤더 (날짜, 생년월일시, 양력/음력, 성별)
  - 사주 분석 결과 섹션:
    1. 사주팔자 기본 구성 (천간·지지, 오행)
    2. 성격 및 기질 (특성, 장단점)
    3. 대운·세운 분석 (현재 시기, 흐름)
    4. 운세 종합 (직업운, 재물운, 건강운, 연애운, 대인관계운)
    5. 조언 및 제안 (긍정적 방향, 주의점)
  - 액션 버튼 (인쇄/PDF 저장, 공유, 대시보드 복귀)

#### 3.2.6 구독 관리 `/subscription`

- **접근 권한**: 인증 필요
- **목적**: 구독 상태 확인 및 결제 관리
- **주요 구성 요소** (사용자 상태별 분기):

  **무료 유저**:
  - 현재 상태 카드 (무료 체험, 사용 현황 X/1회)
  - Pro 요금제 안내 카드 (혜택 목록, 가격, "Pro 구독하기" 버튼)

  **Pro 유저 (정상 구독)**:
  - 구독 정보 카드 (요금제, 시작일, 다음 결제일, 결제 금액)
  - 사용 현황 카드 (이번 달 사용 X/10회, 다음 초기화 날짜)
  - 결제 수단 정보 (카드사, 마지막 4자리)
  - 결제 이력 리스트
  - 구독 취소 버튼 (확인 모달)

  **구독 취소 예정 상태**:
  - 구독 정보 카드 (Pro 취소 예정, 혜택 만료일)
  - 사용 현황 카드 (남은 사용, 만료 후 무료 전환 안내)
  - 구독 재개 버튼 (확인 모달)

---

## 4. 사용자 여정 (User Journey)

### 4.1 타겟 유저 세그먼트

#### 세그먼트 1: 신규 방문자 (Anonymous User)
- **특징**: 서비스에 처음 방문, 사주 분석에 관심
- **목표**: 서비스 이해 및 무료 체험 시작

#### 세그먼트 2: 무료 체험 유저 (Free Tier User)
- **특징**: 회원가입 완료, 1회 무료 분석 제공
- **목표**: 서비스 가치 경험 및 Pro 구독 전환

#### 세그먼트 3: Pro 구독자 (Pro Subscriber)
- **특징**: 월 3,900원 결제, 월 10회 분석 가능
- **목표**: 정기적인 분석 활용 및 구독 유지

### 4.2 사용자 여정별 페이지 플로우

#### 여정 1: 신규 가입 및 첫 분석 (신규 방문자 → 무료 체험 유저)

```
홈(/)
  → [무료로 시작하기 클릭]
  → 회원가입(/sign-up)
  → [Google 로그인 완료]
  → 대시보드(/dashboard)
  → [새 분석하기 버튼 클릭]
  → 새 분석하기(/analysis/new)
  → [생년월일시 입력 및 분석 요청]
  → [AI 분석 중 로딩]
  → 분석 상세보기(/analysis/[id])
  → [결과 확인]
```

**주요 터치포인트**:
- 홈: 서비스 가치 이해, 무료 체험 강조
- 회원가입: 간편한 Google 로그인
- 대시보드: 남은 횟수 표시 (1/1회)
- 분석 페이지: 명확한 입력 가이드
- 결과 페이지: 체계적이고 읽기 쉬운 분석 결과

#### 여정 2: Pro 구독 전환 (무료 체험 유저 → Pro 구독자)

```
대시보드(/dashboard)
  → [무료 1회 사용 완료, "Pro로 업그레이드" 버튼 클릭]
  → 구독 관리(/subscription)
  → [Pro 요금제 혜택 확인]
  → [Pro 구독하기 버튼 클릭]
  → [토스페이먼츠 결제창 - 카드 정보 입력]
  → [결제 승인 및 빌링키 발급]
  → 대시보드(/dashboard)
  → [Pro 상태로 업데이트, 10/10회 표시]
```

**주요 터치포인트**:
- 대시보드: 무료 횟수 소진 알림, Pro 업그레이드 유도
- 구독 관리: 명확한 혜택 및 가격 안내
- 결제창: 안전하고 간편한 카드 등록
- 전환 후: Pro 전용 고품질 모델 강조

#### 여정 3: 정기 분석 활용 (Pro 구독자)

```
대시보드(/dashboard)
  → [이번 달 남은 분석 확인]
  → [새 분석하기 버튼 클릭]
  → 새 분석하기(/analysis/new)
  → [생년월일시 입력 및 분석 요청]
  → 분석 상세보기(/analysis/[id])
  → [Gemini 2.5 Pro 모델 결과 확인]
  → [대시보드로 돌아가기]
  → 대시보드(/dashboard)
  → [과거 분석 이력에서 이전 결과 재확인]
```

**주요 터치포인트**:
- 대시보드: 남은 횟수 및 다음 초기화 날짜 표시
- 분석 결과: Pro 모델 사용으로 더 정확한 해석
- 분석 이력: 과거 결과 영구 보관 및 재열람

#### 여정 4: 구독 관리 (Pro 구독자)

```
대시보드(/dashboard)
  → [구독 관리 링크 클릭]
  → 구독 관리(/subscription)
  → [구독 정보, 결제 수단, 이력 확인]
  → [구독 취소 버튼 클릭]
  → [확인 모달: 다음 결제일까지 혜택 유지 안내]
  → [취소 확인]
  → [구독 상태: Pro (취소 예정)으로 변경]
  → [만료일까지 Pro 기능 사용 가능]
  → (옵션) [구독 재개 버튼 클릭]
  → [정기결제 재시작]
```

**주요 터치포인트**:
- 구독 관리: 투명한 구독 정보 및 결제 이력
- 취소 정책: 만료일까지 혜택 유지 명시
- 재개 옵션: 쉬운 재구독 경로 제공

---

## 5. Information Architecture (IA)

### 5.1 IA Tree 구조

```
마피아 사주 (Mafia Saju)
│
├── 🏠 홈 (/) [공개]
│   ├── 히어로 섹션
│   ├── 주요 특징 (3 Cards)
│   ├── 가격 안내
│   └── CTA 섹션
│
├── 🔐 인증
│   ├── 로그인 (/sign-in) [공개]
│   └── 회원가입 (/sign-up) [공개]
│
├── 📊 대시보드 (/dashboard) [인증 필요]
│   ├── 상단 정보 카드
│   │   ├── 환영 메시지
│   │   ├── 구독 상태 배지
│   │   ├── 남은 분석 횟수
│   │   └── Pro 업그레이드 버튼 (조건부)
│   ├── 새 분석하기 버튼
│   ├── 분석 이력 목록
│   └── 구독 관리 링크
│
├── 🔮 분석
│   ├── 새 분석하기 (/analysis/new) [인증 필요]
│   │   ├── 남은 횟수 상태
│   │   ├── 입력 폼
│   │   │   ├── 생년월일
│   │   │   ├── 출생 시간
│   │   │   ├── 양력/음력
│   │   │   └── 성별
│   │   ├── 분석하기 버튼
│   │   └── 제한 초과 안내 (조건부)
│   │
│   └── 분석 상세보기 (/analysis/[id]) [인증 필요, 본인만]
│       ├── 분석 정보 헤더
│       ├── 사주 분석 결과
│       │   ├── 1. 사주팔자 기본 구성
│       │   ├── 2. 성격 및 기질
│       │   ├── 3. 대운·세운 분석
│       │   ├── 4. 운세 종합
│       │   └── 5. 조언 및 제안
│       └── 액션 버튼
│
├── 💳 구독 관리 (/subscription) [인증 필요]
│   ├── [무료 유저 뷰]
│   │   ├── 현재 상태 카드
│   │   └── Pro 요금제 안내 카드
│   │
│   ├── [Pro 구독 중 뷰]
│   │   ├── 구독 정보 카드
│   │   ├── 사용 현황 카드
│   │   ├── 결제 수단 정보
│   │   ├── 결제 이력
│   │   └── 구독 취소 버튼
│   │
│   └── [구독 취소 예정 뷰]
│       ├── 구독 정보 카드
│       ├── 사용 현황 카드
│       └── 구독 재개 버튼
│
└── 🔧 API & Webhooks [서버 전용]
    ├── /api/[[...hono]] (Hono App Router)
    ├── /api/webhooks/clerk (Clerk 웹훅)
    ├── /api/webhooks/tosspayments (토스페이먼츠 웹훅)
    ├── /api/billing/success (결제 성공 콜백)
    └── /api/billing/fail (결제 실패 콜백)
```

### 5.2 네비게이션 구조

#### 5.2.1 글로벌 네비게이션 (인증 전)
```
로고 [홈으로] | 무료로 시작하기 [회원가입] | 로그인 [로그인]
```

#### 5.2.2 글로벌 네비게이션 (인증 후)
```
로고 [대시보드] | 새 분석하기 | 구독 관리 | UserButton [프로필/로그아웃]
```

#### 5.2.3 정보 계층 구조
```
Level 1: 홈/대시보드 (최상위 허브)
  ├── Level 2: 분석 섹션 (새 분석, 이력)
  ├── Level 2: 구독 관리
  └── Level 2: 인증 (로그인/회원가입)
      └── Level 3: 분석 상세보기 (개별 결과)
```

---

## 6. 기능 명세

### 6.1 인증 시스템 (Clerk)

#### 6.1.1 핵심 기능
- Google 소셜 로그인
- 회원가입 및 로그인 플로우
- 사용자 세션 관리
- 보호된 라우트 구현 (홈 제외 모든 페이지)

#### 6.1.2 기술 구현
- **SDK**: `@clerk/nextjs`
- **Middleware**: `middleware.ts`를 통한 라우트 보호
- **Webhook**: `user.created`, `user.deleted` 이벤트로 Supabase 동기화
- **환경 변수**:
  - `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY`
  - `CLERK_SECRET_KEY`
  - `CLERK_WEBHOOK_SIGNING_SECRET`

#### 6.1.3 요구사항
- Clerk 기본 제공 컴포넌트 활용 (SignIn, SignUp, UserButton)
- 미인증 사용자는 보호된 페이지 접근 시 로그인 페이지로 리다이렉트
- 홈(랜딩) 페이지는 인증 없이 접근 가능
- Webhook 엔드포인트는 `middleware.ts`에서 공개 경로로 설정

---

### 6.2 결제 시스템 (토스페이먼츠)

#### 6.2.1 핵심 기능
- 구독 결제 연동 (월 3,900원)
- 빌링키 발급 및 관리
- 정기결제 처리
- 구독 취소 및 재구독 기능
- 결제 이력 조회

#### 6.2.2 기술 구현
- **SDK**: `@tosspayments/payment-sdk` (클라이언트)
- **API**:
  - `POST /v1/billing/authorizations/issue` (빌링키 발급)
  - `POST /v1/billing/{billingKey}` (정기결제 승인)
- **Webhook**: `PAYMENT_STATUS_CHANGED` 이벤트 수신
- **환경 변수**:
  - `NEXT_PUBLIC_TOSS_CLIENT_KEY`
  - `TOSS_SECRET_KEY`

#### 6.2.3 가격 정책
- **무료**: 1회 체험 제공
- **Pro 구독**: 월 3,900원, 월 10회 분석

#### 6.2.4 빌링키 관리
- 구독 해지 시 즉시 빌링키 삭제
- 재구독 시 새로운 빌링키 발급 필요

#### 6.2.5 구독 취소 정책
- 취소 시에도 다음 결제일까지 Pro 혜택 유지
- 다음 결제일 전까지 취소 철회 가능
- 취소 철회 시 기존 빌링키로 정기결제 재개

#### 6.2.6 결제 실패 처리
- 결제 실패 시 재시도 로직 구현
- 연속 실패 시 구독 자동 해지 및 알림

#### 6.2.7 보안 요구사항
- 결제 관련 API는 반드시 서버 사이드에서 처리
- Webhook 검증 필수 (IP 대역 또는 시그니처)
- 시크릿 키는 환경 변수로 관리, 클라이언트 노출 금지

---

### 6.3 사주 분석 시스템 (Gemini API)

#### 6.3.1 핵심 기능
- 생년월일시 입력 폼
- Gemini 2.5 Flash (무료 유저용)
- Gemini 2.5 Pro (Pro 구독자용)
- 천간·지지·대운·세운 계산 및 해석
- 분석 결과 생성 및 저장
- 분석 이력 영구 보관

#### 6.3.2 기술 구현
- **SDK**: `@google/generative-ai`
- **모델 분기**:
  - 무료 유저: `gemini-2.5-flash`
  - Pro 유저: `gemini-2.5-pro`
- **환경 변수**:
  - `GEMINI_API_KEY`

#### 6.3.3 분석 내용
- 천간·지지 계산
- 대운·세운 분석
- 종합 사주팔자 해석 (성격, 직업운, 재물운, 건강운, 연애/결혼운, 대인관계운)

#### 6.3.4 에러 처리
- API 호출 실패 시 재시도 로직 (최대 3회)
- 사용량 차감 전 API 성공 여부 확인
- 실패 시 사용자에게 명확한 에러 메시지 제공

#### 6.3.5 프롬프트 최적화
- 일관된 사주 분석 결과를 위한 구조화된 프롬프트 작성
- 천간·지지·대운·세운을 체계적으로 해석하는 프롬프트 설계
- 분석 결과는 읽기 쉬운 형식으로 포맷팅

---

### 6.4 사용량 관리 시스템

#### 6.4.1 핵심 기능
- 무료 유저: 1회 체험 제한
- Pro 유저: 월 10회 제한 카운팅
- 월별 사용량 초기화 로직
- 사용 가능 횟수 표시

#### 6.4.2 카운팅 로직
- 분석 요청 **성공 시에만** 사용량 차감
- 동시 요청으로 인한 초과 사용 방지 (트랜잭션 처리)

#### 6.4.3 월별 초기화
- 구독 시작일 기준으로 월 단위 초기화
- 예: 1월 15일 구독 시작 → 매월 15일 초기화

#### 6.4.4 제한 초과 시
- Pro 업그레이드 안내 (무료 유저)
- 다음 초기화 날짜 안내 (Pro 유저)

---

### 6.5 데이터베이스 스키마 (Supabase)

#### 6.5.1 테이블 구조

**users 테이블**
```sql
- id: UUID (Primary Key)
- clerk_user_id: TEXT (Unique, Clerk 사용자 ID)
- email: TEXT
- subscription_tier: TEXT (default: 'free', values: 'free' | 'pro')
- billing_key: TEXT (토스페이먼츠 빌링키)
- customer_key: TEXT (토스페이먼츠 고객키)
- created_at: TIMESTAMPTZ
- updated_at: TIMESTAMPTZ
```

**subscriptions 테이블**
```sql
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key → users.id)
- plan: TEXT (values: 'free' | 'pro')
- status: TEXT (values: 'active' | 'canceled' | 'expired')
- billing_key: TEXT
- customer_key: TEXT
- started_at: TIMESTAMPTZ
- next_billing_date: TIMESTAMPTZ
- canceled_at: TIMESTAMPTZ (nullable)
- created_at: TIMESTAMPTZ
- updated_at: TIMESTAMPTZ
```

**analyses 테이블** (영구 보관)
```sql
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key → users.id)
- birth_date: DATE
- birth_time: TIME (nullable, "모름" 가능)
- is_lunar: BOOLEAN
- gender: TEXT (values: 'male' | 'female')
- result: JSONB (분석 결과 전체 저장)
- model_used: TEXT (values: 'gemini-2.5-flash' | 'gemini-2.5-pro')
- created_at: TIMESTAMPTZ
```

**usage_records 테이블**
```sql
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key → users.id)
- month: DATE (YYYY-MM-01 형식)
- count: INTEGER (해당 월 사용 횟수)
- limit: INTEGER (해당 월 최대 횟수, 무료: 1, Pro: 10)
- created_at: TIMESTAMPTZ
- updated_at: TIMESTAMPTZ
```

**payment_history 테이블**
```sql
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key → users.id)
- payment_key: TEXT (토스페이먼츠 결제 키)
- order_id: TEXT (고유 주문 ID)
- amount: INTEGER (결제 금액)
- status: TEXT (values: 'DONE' | 'ABORTED' | 'CANCELED')
- paid_at: TIMESTAMPTZ
- created_at: TIMESTAMPTZ
```

#### 6.5.2 데이터 관리 정책

**영구 보관 정책**
- 모든 분석 결과는 삭제하지 않고 영구 보관
- 사용자는 대시보드에서 언제든 과거 분석 조회 가능

**데이터 보안**
- 개인정보 (생년월일시) 암호화 저장 권장
- 환경 변수로 모든 API 키 관리 (.env 파일, Git 제외)
- HTTPS 필수
- Row Level Security (RLS) 비활성화 (요구사항 명시)

---

## 7. 기술 스택

### 7.1 프론트엔드

| 기술 | 버전 | 용도 |
|------|------|------|
| **Next.js** | 15.1.0 | React 프레임워크, App Router |
| **React** | 19.0.0 | UI 라이브러리 |
| **TypeScript** | 5.x | 정적 타입 체크 |
| **Tailwind CSS** | 4.1.13 | Utility-first CSS |
| **shadcn-ui** | - | 접근 가능한 UI 컴포넌트 |
| **Lucide React** | 0.469.0 | 아이콘 |
| **React Hook Form** | 7.x | 폼 상태 관리 |
| **Zod** | 3.x | 스키마 검증 |
| **Tanstack React Query** | 5.x | 서버 상태 관리 |
| **Zustand** | 4.x | 경량 글로벌 상태 관리 |
| **date-fns** | 4.x | 날짜/시간 처리 |
| **ts-pattern** | 5.x | 타입 안전 분기 로직 |
| **react-use** | 17.x | React 훅 유틸리티 |
| **es-toolkit** | 1.x | 유틸리티 함수 |
| **Framer Motion** | 11.x | 애니메이션 |

### 7.2 백엔드

| 기술 | 버전 | 용도 |
|------|------|------|
| **Hono** | 4.9.9 | 경량 HTTP 프레임워크 |
| **Supabase** | 2.58.0 | BaaS, PostgreSQL 데이터베이스 |
| **Clerk** | latest | 사용자 인증 및 세션 관리 |
| **토스페이먼츠** | - | 구독 결제 시스템 |
| **Google Gemini AI** | - | AI 사주 분석 모델 |

### 7.3 개발 도구

| 기술 | 버전 | 용도 |
|------|------|------|
| **ESLint** | 9.x | 코드 린팅 |
| **PostCSS** | 8.x | CSS 후처리 |
| **npm** | - | 패키지 관리자 |

### 7.4 인프라

- **호스팅**: Vercel (권장)
- **데이터베이스**: Supabase (PostgreSQL)
- **인증**: Clerk
- **결제**: 토스페이먼츠
- **AI**: Google Gemini API

---

## 8. 비기능 요구사항

### 8.1 성능

- **페이지 로딩**: First Contentful Paint(FCP) < 1.5초
- **AI 분석 응답**: 평균 5-10초 이내
- **API 응답 시간**: 평균 200ms 이하 (AI 제외)
- **동시 사용자**: 최대 1,000명 동시 접속 지원

### 8.2 보안

- **인증**: Clerk를 통한 안전한 세션 관리
- **API 키 관리**: 모든 키는 환경 변수로 관리, Git 제외
- **HTTPS**: 모든 통신은 HTTPS로 암호화
- **Webhook 검증**: Clerk 및 토스페이먼츠 Webhook 서명 검증 필수
- **XSS/CSRF 방지**: Next.js 기본 보안 기능 활용
- **개인정보 보호**: 생년월일시 등 민감 정보 암호화 권장

### 8.3 가용성

- **업타임**: 99.5% 이상
- **에러 복구**: API 실패 시 최대 3회 재시도
- **모니터링**: 에러 로깅 및 알림 시스템 구축

### 8.4 확장성

- **데이터베이스**: Supabase의 확장 가능한 PostgreSQL
- **API**: Hono를 통한 경량 및 고성능 라우팅
- **캐싱**: React Query를 통한 클라이언트 캐싱

### 8.5 접근성

- **WCAG 2.1 AA 준수**: shadcn-ui를 통한 접근 가능한 컴포넌트
- **키보드 네비게이션**: 모든 인터랙션 요소 키보드 접근 가능
- **스크린 리더**: Semantic HTML 및 ARIA 속성 활용

### 8.6 모바일 반응형

- **반응형 디자인**: 모든 페이지는 모바일, 태블릿, 데스크톱 대응
- **터치 최적화**: 모바일 터치 인터랙션 지원
- **최소 해상도**: 320px (iPhone SE) 이상

### 8.7 브라우저 지원

- Chrome (최신 2개 버전)
- Safari (최신 2개 버전)
- Firefox (최신 2개 버전)
- Edge (최신 2개 버전)

### 8.8 데이터 백업

- **자동 백업**: Supabase의 일일 자동 백업
- **복구 시간 목표(RTO)**: 24시간 이내
- **복구 시점 목표(RPO)**: 최대 1일 데이터 손실 허용

---

## 9. UX/UI 가이드라인

### 9.1 디자인 톤

- **심플하고 깔끔한 인터페이스**: 정보 과부하 방지
- **카드 기반 레이아웃**: 명확한 정보 그룹화
- **명확한 정보 위계**: 타이포그래피 및 여백 활용

### 9.2 주요 강조 사항

- "AI 기반 정확한 분석" 강조
- "합리적인 가격" (월 3,900원) 부각
- "검사 내역 영구 보관" 명시

### 9.3 인터랙션

- **로딩 상태**: AI 분석 시간 소요 명확히 표시 (스피너 + 메시지)
- **남은 사용 횟수**: 모든 관련 페이지에서 항상 표시
- **구독 상태 표시**: 배지 및 카드로 시각적 구분
- **다음 결제일**: Pro 구독자에게 명시
- **모바일 반응형**: 모든 인터랙션 요소 터치 최적화

### 9.4 컬러 팔레트 (권장)

- **Primary**: 보라색 계열 (신비로움, 정확성 강조)
- **Secondary**: 골드/노란색 계열 (프리미엄 느낌)
- **Accent**: 파란색 계열 (신뢰감)
- **Background**: 화이트/라이트 그레이
- **Text**: 다크 그레이/블랙

### 9.5 타이포그래피

- **제목**: 굵고 명확한 서체 (예: Pretendard Bold)
- **본문**: 가독성 높은 서체 (예: Pretendard Regular)
- **강조**: 중간 굵기 (예: Pretendard Medium)

---

## 10. 성공 지표 (KPI)

### 10.1 비즈니스 지표

| 지표 | 목표 | 측정 방법 |
|------|------|----------|
| **신규 가입자 수** | 월 500명 | Clerk 가입 이벤트 추적 |
| **무료→Pro 전환율** | 20% 이상 | 무료 체험 후 Pro 구독 비율 |
| **월간 활성 사용자(MAU)** | 월 300명 | 월 1회 이상 로그인 사용자 |
| **Pro 구독 유지율** | 80% 이상 (3개월) | 구독 3개월 이상 유지 비율 |
| **월 매출(MRR)** | 100만원 이상 | Pro 구독자 수 × 3,900원 |
| **평균 사용자당 수익(ARPU)** | 3,900원 이상 | 총 매출 / 활성 사용자 수 |

### 10.2 제품 사용 지표

| 지표 | 목표 | 측정 방법 |
|------|------|----------|
| **무료 체험 사용률** | 80% 이상 | 가입 후 1회 분석 완료 비율 |
| **Pro 유저 평균 사용 횟수** | 월 5회 이상 | 분석 테이블에서 월별 평균 계산 |
| **분석 완료율** | 95% 이상 | 분석 시작 대비 완료 비율 |
| **분석 이력 재열람율** | 30% 이상 | 과거 분석 재조회 비율 |
| **세션당 페이지 뷰** | 평균 5 이상 | Google Analytics |

### 10.3 기술 지표

| 지표 | 목표 | 측정 방법 |
|------|------|----------|
| **AI 분석 성공률** | 98% 이상 | Gemini API 호출 성공/실패 비율 |
| **결제 성공률** | 95% 이상 | 토스페이먼츠 승인/실패 비율 |
| **페이지 로딩 시간(FCP)** | < 1.5초 | Vercel Analytics |
| **API 응답 시간** | < 200ms | Hono 서버 로깅 |
| **에러율** | < 1% | 에러 로깅 시스템 |

### 10.4 사용자 만족도 지표

| 지표 | 목표 | 측정 방법 |
|------|------|----------|
| **NPS (Net Promoter Score)** | 40 이상 | 분기별 설문 조사 |
| **사용자 평점** | 4.5/5.0 이상 | 인앱 피드백 수집 |
| **고객 지원 응답 시간** | 24시간 이내 | 고객 지원 티켓 시스템 |

---

## 11. 릴리스 계획

### 11.1 Phase 1: MVP (Minimum Viable Product)

**목표**: 핵심 기능 출시 및 시장 검증

**기능**:
- 인증 시스템 (Clerk)
- 무료 1회 체험
- Pro 구독 결제 (토스페이먼츠)
- AI 사주 분석 (Gemini API)
- 분석 이력 조회

**기간**: 4-6주

### 11.2 Phase 2: 기능 개선

**목표**: 사용자 피드백 반영 및 기능 확장

**기능**:
- 분석 결과 PDF 저장
- 분석 결과 공유 기능
- 결제 이력 상세 조회
- 사용자 대시보드 개선

**기간**: MVP 출시 후 2-4주

### 11.3 Phase 3: 추가 기능

**목표**: 사용자 참여도 증대 및 리텐션 향상

**기능**:
- 궁합 분석 (2인 사주 비교)
- 맞춤형 운세 알림
- 분석 결과 비교 기능
- 사용자 커뮤니티

**기간**: Phase 2 출시 후 6-8주

---

## 12. 리스크 관리

### 12.1 기술적 리스크

| 리스크 | 영향도 | 완화 방안 |
|--------|--------|----------|
| **Gemini API 호출 실패** | 높음 | 재시도 로직, 에러 핸들링, 사용량 차감 전 검증 |
| **토스페이먼츠 결제 실패** | 높음 | 재시도 로직, 명확한 에러 메시지, 고객 지원 연계 |
| **Clerk 인증 장애** | 중간 | Fallback 페이지, 상태 모니터링 |
| **Supabase 데이터베이스 다운타임** | 높음 | 자동 백업, 복구 절차 문서화 |
| **동시 요청으로 인한 사용량 초과** | 중간 | 트랜잭션 처리, 낙관적 잠금 |

### 12.2 비즈니스 리스크

| 리스크 | 영향도 | 완화 방안 |
|--------|--------|----------|
| **낮은 무료→Pro 전환율** | 높음 | A/B 테스트, 가격 실험, 혜택 강화 |
| **높은 구독 취소율** | 높음 | 사용자 피드백 수집, 제품 개선, 리텐션 캠페인 |
| **AI 분석 품질 불만** | 높음 | 프롬프트 최적화, Pro 모델 강조, 피드백 반영 |
| **경쟁 서비스 등장** | 중간 | 차별화 요소 강화, 가격 경쟁력, 커뮤니티 구축 |

### 12.3 법적/윤리적 리스크

| 리스크 | 영향도 | 완화 방안 |
|--------|--------|----------|
| **개인정보 보호법 위반** | 높음 | 암호화 저장, HTTPS 필수, 개인정보 처리방침 명시 |
| **결제 정보 유출** | 매우 높음 | PCI-DSS 준수 (토스페이먼츠 의존), 서버 사이드 처리 |
| **AI 생성 콘텐츠 책임** | 중간 | 면책 조항 명시, "참고용" 강조 |

---

## 13. 참고 문서

- [Clerk Documentation](https://clerk.com/docs)
- [토스페이먼츠 개발자 문서](https://docs.tosspayments.com)
- [Supabase Documentation](https://supabase.com/docs)
- [Google Gemini API Documentation](https://ai.google.dev/docs)
- [Next.js App Router Documentation](https://nextjs.org/docs/app)
- [Hono Documentation](https://hono.dev)

---

## 14. 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2025-10-27 | - | 초기 PRD 작성 |

---

## 15. 승인

본 PRD는 다음 이해관계자의 승인을 받아야 합니다:

- [ ] 제품 관리자
- [ ] 개발 리드
- [ ] 디자인 리드
- [ ] 운영 담당자
